# ABBA_Coregistration_Analysis_Tools
Scripts to aid data pre- and post-processing when coregistering 3D mouse brains with Nicolas Chiaruttini's ABBA tool
Please reference this protocol for more information: https://www.protocols.io/view/a-free-analysis-pipeline-to-coregister-3d-lightshe-dcgz2tx6
The general order and use of the scripts downloadable at this github address are as follows:
1. The reslice.py script allows reslicing of an image in Z by a customizable factor. Use this to reduce the number of sections being imported into ABBA, if necessary.
2. The channel_macro (s) convert an image series where the channels have been split into an image series where each slice contains all channels. Please use this macro if importing multiple channels into ABBA. There are multiple versions of this macro that correspond to the number of channels being imported into ABBA. For example, channel_macro_2 is for two channels, channel_macro_3 is for three channels, etc.
3. After coregistration and segmentation, the cells macro will analyze all coregisetered, segmented slices in a folder and save the results in a series of .csv files.
4. The excel_crunch.py script combines the .csv files generated by the above macro into a single file, aggregating all data into one row per region and one column per statistic.
5. The excel_merge.py script combines multiple .csv outputs of excel_crunch.py into a single .csv file. Importantly, excel_merge is designed to handle excel_crunch outputs whose brain regions exist in differing orders, or otherwise missing regions, which may occur due to differing coregistrations changing which regions the cells_macro encounters first, or certain regions being discluded when exporting the coregistered brain (which is a factor that prevents simple copy+pasting between excel files). Please note that excel_merge.py is deprecated and may not run beyond pandas 2.2.0. If this occurs, please revert pandas to version 2.2.0.
6. The stat_test.py and stat_test_clusters.py are designed to establish significant differences between regions. These tests should be run on two excel files containing the data from two cohorts, in the order that they are generated by excel_merge.py. 
